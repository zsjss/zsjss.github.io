<!doctype html>
<html lang="en">
<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="songroger">

  <title>Regular use of Mitmproxy</title>

  <meta name="description" content="&lt;h3 id=&quot;install-the-certificate&quot;&gt;Install the certificate&lt;/h3&gt;&lt;p&gt;Just start mitmproxy and configure your target device with the co...">

  <!-- Open graph data -->
  <meta property="og:site_name" content="songroger">
  <meta property="og:title" content="Regular use of Mitmproxy">
  <meta property="og:url" content="http://localhost:4000/use-of-mitmproxy/">
  <meta property="og:type" content="article">
  <meta property="og:description" content="&lt;h3 id=&quot;install-the-certificate&quot;&gt;Install the certificate&lt;/h3&gt;&lt;p&gt;Just start mitmproxy and configure your target device with the co...">

  <!-- Standard Stuff -->
  <link rel="canonical" href="http://localhost:4000/use-of-mitmproxy/"/>
  <link rel="alternate" type="application/rss+xml" title="songroger" href="http://localhost:4000/feed.xml"/>

  <!-- Favicons -->
  <link rel="shortcut icon" href="http://7xof48.com1.z0.glb.clouddn.com/favicon.png">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-config" content="/assets/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">

  <!-- Styles -->
  
    <link rel="stylesheet" href="http://7xof48.com1.z0.glb.clouddn.com/songroger/main.min.css">
  


</head>

<body>

  <header class="header">

    
      <div class="header__logo">
        <a href="/" class="header__link--logo">
        <!-- <div class="spinner"></div> -->
        <img src="http://7xof48.com1.z0.glb.clouddn.com/avatar.jpg"></a>
      </div>
    

    <nav class="header__nav" role="navigation">      
      <a href="/archive/" class="header__link">Archive</a>
      <a href="http://twitter.com/songrogero" class="header__link" target="_blank">Twitter</a>
      <!-- <a href="http://github.com/songroger" class="header__link" target="_blank">Github</a> -->
      <a href="http://facebook.com/song.roger.1" class="header__link" target="_blank">Facebook</a>
      <a href="/about/" class="header__link">About</a>
    </nav>
  </header>

  <main class="col">


<article class="article">
  <h2 class="article__title article__title--single">Regular use of Mitmproxy</h2>
  <time class="article__date" datetime="2017-02-21"> 20:15 Feb.21-2017</time>
  
  <h3 id="install-the-certificate">Install the certificate</h3>
<p>Just start mitmproxy and configure your target device with the correct proxy settings. Now start a browser on the device, and visit the magic domain <strong><a href="http://mitm.it">mitm.it</a></strong>. 
Click on the relevant icon to install the certificate.</p>

<p><em>Note: You should go to the system settings-&gt;security-&gt;certificates to import the ca. for some android devices.</em></p>

<h3 id="interception">Interception</h3>
<p>Mitmproxy’s interception functionality lets you pause an HTTP request or response, inspect and modify it, and then accept it to send it on to the server or client.</p>

<ol>
  <li><code class="highlighter-rouge">&gt;&gt;&gt; mitmproxy</code></li>
  <li>Press <code class="highlighter-rouge">i</code> to set an interception filter.eg “~q”. 
Intercepted connections are indicated with <strong>orange</strong> text</li>
  <li>View and modify the request:
viewed the request by selecting it, pressed <code class="highlighter-rouge">e</code> for “edit”</li>
  <li>Press <code class="highlighter-rouge">a</code> to accept the modified request, which is then sent on to the server</li>
</ol>

<h3 id="inline-scripts">Inline Scripts</h3>
<p>Use your own scripts to get the response.</p>

<p>examples/test.py</p>
<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">response</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">flow</span><span class="p">):</span>
    <span class="n">flow</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s">"newheader"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"foo"</span>
    <span class="k">if</span> <span class="n">flow</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">host</span> <span class="o">==</span> <span class="s">"eg.com"</span><span class="p">:</span>
        <span class="n">flow</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">scheme</span> <span class="o">=</span> <span class="s">"http"</span>
        <span class="n">flow</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="mi">8080</span>
        <span class="n">flow</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">flow</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="s">"v1/"</span><span class="p">,</span> <span class="s">"v2/"</span><span class="p">)</span>
</code></pre>
</div>

<ol>
  <li><code class="highlighter-rouge">&gt;&gt;&gt; mitmdump -s test.py</code></li>
  <li><code class="highlighter-rouge">&gt;&gt;&gt; mitmproxy -s test.py</code></li>
</ol>

  
    <div class="post-tags"><a href="http://docs.mitmproxy.org/en/v0.17/mitmproxy.html#example-interception">[More]</a></div>
  
</article>

<div class="blocks">
  <div class="block__item block__item--mr">
    <a href="https://twitter.com/intent/tweet?text=Regular use of Mitmproxy&amp;url=http://localhost:4000/use-of-mitmproxy/&amp;via=songrogero">
      <svg class="btn__icon" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <title>Twitter Icon</title>
        <path d="M14.4 4.2C14.4 4.4 14.4 4.5 14.4 4.7 14.4 9 11.1 14 5 14 3.2 14 1.5 13.5 0 12.5 0.3 12.6 0.5 12.6 0.8 12.6 2.3 12.6 3.7 12 4.9 11.2 3.4 11.1 2.2 10.2 1.8 8.9 2 8.9 2.2 8.9 2.4 8.9 2.7 8.9 3 8.9 3.3 8.8 1.8 8.5 0.6 7.2 0.6 5.6L0.6 5.6C1.1 5.8 1.6 6 2.1 6 1.2 5.4 0.7 4.4 0.7 3.2 0.7 2.6 0.8 2.1 1.1 1.6 2.7 3.6 5.2 4.9 7.9 5 7.8 4.8 7.8 4.5 7.8 4.3 7.8 2.5 9.3 1 11.1 1 12 1 12.9 1.4 13.5 2 14.2 1.9 14.9 1.6 15.6 1.2 15.3 2 14.8 2.6 14.1 3.1 14.8 3 15.4 2.8 16 2.5 15.6 3.2 15 3.8 14.4 4.2L14.4 4.2Z"/>
      </svg>
    </a>
  </div>
  <div class="block__item">
    <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/use-of-mitmproxy/">
      <svg class="btn__icon" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <title>Facebook Icon</title>
        <path d="M9.5 3L12 3 12 0 9.5 0C7.6 0 6 1.6 6 3.5L6 5 4 5 4 8 6 8 6 16 9 16 9 8 11.5 8 12 5 9 5 9 3.5C9 3.2 9.2 3 9.5 3L9.5 3Z"/>
      </svg>
    </a>
  </div>
</div>
<hr>
<p id="back-to-top"><a href="#top"><img src="http://7xof48.com1.z0.glb.clouddn.com/songroger/top.png"/></a></p>
<script src="http://libs.baidu.com/jquery/1.9.1/jquery.min.js"></script>
<script src="http://7xof48.com1.z0.glb.clouddn.com/songroger/top.js"></script>

<!-- disqus 评论-->
<!-- <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'songroger'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> -->

<!-- 多说评论框 start -->
<div class="ds-thread" data-thread-key="songroger" data-title="Regular use of Mitmproxy" data-url="http://localhost:4000/use-of-mitmproxy/"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"songroger"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>
<!-- 多说公共JS代码 end -->


<footer class="footer">
	<div class="col">
		© 2014-2016 Songroger | <a href="/feed.xml" class="subscribe">RSS</a>
	</div>
</footer>
<script type="text/javascript">
  //友盟统计
  var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
  document.write(unescape("%3Cspan style='display:none;' id='cnzz_stat_icon_1260641879'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s95.cnzz.com/z_stat.php%3Fid%3D1260641879' type='text/javascript'%3E%3C/script%3E"));
</script>
</body>
</html>
